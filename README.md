# Dairy AI Forecast ğŸ„ğŸ¥›

An interactive web app using XGBoost & the Gemini API to forecast weekly milk volume and fat percentage for US states. Users select a state, milk type (Organic, Grass-Fed), and forecast period to receive AI-generated predictions and analysis based on historical and weather data.

---

## Introduction

**Dairy AI Forecast** is a web application that uses machine learning and generative AI to predict weekly milk volume and milk fat percentage for various U.S. states. The application features an interactive map where users can select a state, a type of milk production (e.g., Organic, Grass-Fed), and a forecast period to receive a detailed prediction.

The core of the project is a two-step prediction chain:
- An XGBoost model predicts future milk fat percentage based on historical data, weather, and milk type.
- A second XGBoost model takes that fat percentage prediction as a feature, along with other data, to predict the final milk volume.

The reasoning for each forecast is dynamically generated by Google's Gemini API, providing unique, context-aware explanations for each prediction.

---

## Key Features

- **Interactive Map UI:** A clean, modern interface built with Leaflet.js allows users to visually select states.
- **Dynamic Controls:** Users can select the forecast period (in weeks) and the specific type of milk to get tailored predictions.
- **Dual-Model Prediction Chain:** Utilizes two fine-tuned XGBoost models for a more accurate and nuanced forecast.
- **Generative AI Reasoning:** Integrates with the Google Gemini API to provide natural language explanations for the model's predictions.
- **Data-Driven:** Models are trained on real-world weekly production data, enriched with historical weather information from Meteostat.

---

## Tech Stack

- **Backend:** Python, Flask  
- **Machine Learning:** scikit-learn, XGBoost, pandas, NumPy  
- **Generative AI:** Google Generative AI (Gemini API)  
- **Data Fetching:** Meteostat (weather data)  
- **Frontend:** HTML, CSS, JavaScript, Leaflet.js  

---

## Project Structure
```
/Dairy-AI-Forecast
â”‚
â”œâ”€â”€ app.py                      \# Main Flask web server
â”œâ”€â”€ requirements.txt            \# Python dependencies
â”œâ”€â”€ README.md                   \# You are here!
â”œâ”€â”€ .gitignore                  \# Files to ignore in Git (e.g., .env)
â”œâ”€â”€ .env                        \# Local API key (not in repo)
â”‚
â”œâ”€â”€ /models                     \# Models, training scripts, and data
â”‚   â”œâ”€â”€ milk_production_model.joblib
â”‚   â”œâ”€â”€ model_columns.joblib
â”‚   â”œâ”€â”€ fat_percentage_model.joblib
â”‚   â”œâ”€â”€ fat_model_columns.joblib
â”‚   â”œâ”€â”€ train_model_volume.py   \# Script to train the volume model
â”‚   â”œâ”€â”€ train_model_fat.py      \# Script to train the fat model
â”‚   â”œâ”€â”€ milk_data.xlsx          \# Milk volume training data
â”‚   â””â”€â”€ Fat_Percentage.xlsx     \# Milk fat training data
â”‚
â”œâ”€â”€ /templates
â”‚   â””â”€â”€ index.html              \# Frontend HTML file
â”‚
â””â”€â”€ /static
â””â”€â”€ style.css               \# Frontend styling (CSS)

```

---

## Setup and Installation

1. **Clone the repository**

```

git clone https://github.com/suryacks/Dairy-AI-Forecast-.git
cd Dairy-AI-Forecast

```

2. **Create and activate a virtual environment**

*macOS/Linux:*

```

python3 -m venv .venv
source .venv/bin/activate

```

*Windows:*

```

python -m venv .venv
.\.venv\Scripts\activate

```

3. **Install dependencies**

```

pip install -r requirements.txt

```

4. **Set up your Gemini API key**

- Create a `.env` file in the root directory.
- Add your API key:

  ```
  GEMINI_API_KEY="YOUR_API_KEY_HERE"
  ```

5. **Data and training scripts**

- Pre-trained models are ready for immediate use.
- Training data (`milk_data.xlsx`, `Fat_Percentage.xlsx`) and training scripts (`train_model_volume.py`, `train_model_fat.py`) are available in the `/models` folder for reference or retraining.

---

## Running the Application

1. **Start the Flask web server**

```

python app.py

```

2. **Use the application**

Open your browser and navigate to [http://127.0.0.1:5000](http://127.0.0.1:5000) to interact with the app.

---
